# Decrypt TLS 1.3 Packets


### 주어진 pcapng 파일로부터 TCP payload를 추출하여 client가 보낸 데이터와 받은 데이터를 각각 역직렬화하여 TLS Record로 만든다.

* client: 192.168.0.2:54321
* server: www.google.com(142.251.8.105:443)

```
========================================================================================================================
   1-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	SYN                   0 bytes
========================================================================================================================
   2-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	SYN, ACK              0 bytes
========================================================================================================================
   3-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	ACK                   0 bytes
========================================================================================================================
   4-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	PSH, ACK            199 bytes
------------------------------------------------------------------------------------------------------------------------
00000000: 16 03 01 00 c2 01 00 00 be 03 03 00 00 00 00 00  ................  
00000010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 13 01  ................  
00000030: 13 02 c0 2b c0 2c c0 2f c0 30 01 00 00 89 00 00  ...+.,./.0......  
========================================================================================================================
   5-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	ACK                   0 bytes
========================================================================================================================
   6-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	PSH, ACK           2624 bytes
------------------------------------------------------------------------------------------------------------------------
00000000: 16 03 03 00 7b 02 00 00 77 03 03 34 e2 af 2f 7c  ....{...w..4../|  
00000010: 45 ae 21 8a ec c7 dc ee 69 14 7f 7a dd 13 97 0d  E.!.....i..z....  
00000020: f5 4b ae 0f 8c 5f e4 0c 58 bf b9 00 13 01 00 00  .K..._..X.......  
00000030: 4f 00 33 00 45 00 17 00 41 04 4c 49 89 78 ad b0  O.3.E...A.LI.x..  
========================================================================================================================
   7-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	ACK                   0 bytes
========================================================================================================================
   8-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	PSH, ACK              6 bytes
------------------------------------------------------------------------------------------------------------------------
00000000: 14 03 03 00 01 01                                ......            
========================================================================================================================
   9-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	ACK                   0 bytes
========================================================================================================================
  10-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	PSH, ACK            298 bytes
------------------------------------------------------------------------------------------------------------------------
00000000: 17 03 03 00 35 94 aa c9 20 27 a5 48 5a 1f 3b 70  ....5....'.HZ.;p  
00000010: 14 75 0f d6 b8 a1 33 07 4a 9f 5a cb 54 84 61 38  .u....3.J.Z.T.a8  
00000020: 0e 2c f2 f9 f7 ec 4f 22 ad 0d 9d 01 ba 37 71 e0  .,....O".....7q.  
00000030: 14 f1 ed 12 b1 41 09 3c c6 aa 17 03 03 00 eb 13  .....A.<........  
========================================================================================================================
  11-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	ACK                   0 bytes

생략

========================================================================================================================
 136-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	FIN, ACK              0 bytes
========================================================================================================================
 137-th packet    142.251.8.105:443    ->      192.168.0.2:54321 	FIN, ACK              0 bytes
========================================================================================================================
 138-th packet      192.168.0.2:54321  ->    142.251.8.105:443   	ACK                   0 bytes

total 138 packets
client sent 503 bytes and recieved 117622 bytes
clinet sent 4 records and recieved 93 records
```

### client_hello 메시지

* client가 보낸 첫번째 record가 handshake를 시작하는 client_hello 메시지 이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : handshake
version                         : TLS 1.0
length                          : 194
data_of_type
    type                            : client_hello
    length                          : 190
    data_of_type
        version                         : TLS 1.2
        random                          : 0000000000000000000000000000000000000000000000000000000000000000
        session_ID_length               : 0
        session_ID                      : 
        cipher_suites_length            : 12
        cipher_suites                   : ['TLS_AES_128_GCM_SHA256', 'TLS_AES_256_GCM_SHA384', 'TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256', 'TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384', 'TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256', 'TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384']
        compression_methods_length      : 1
        compression_methods             : ['NULL']
        extensions_length               : 137
        list_of_extensions
A list of 7 dictionaries
------------------------------------------------------------------------------------------------------------------------
            type                            : server_name
            length                          : 19
            data_of_type                    : ['www.google.com']
------------------------------------------------------------------------------------------------------------------------
            type                            : supported_groups
            length                          : 4
            data_of_type                    : ['secp256r1']
------------------------------------------------------------------------------------------------------------------------
            type                            : ec_point_formats
            length                          : 2
            data_of_type                    : ['uncompressed']
------------------------------------------------------------------------------------------------------------------------
            type                            : session_ticket
            length                          : 0
            data_of_type                    : 
------------------------------------------------------------------------------------------------------------------------
            type                            : signature_algorithms
            length                          : 8
            data_of_type                    : ['ecdsa_secp256r1_sha256', 'rsa_pss_rsae_sha256', 'rsa_pkcs1_sha256']
------------------------------------------------------------------------------------------------------------------------
            type                            : supported_versions
            length                          : 5
            data_of_type                    : ['TLS 1.3', 'TLS 1.2']
------------------------------------------------------------------------------------------------------------------------
            type                            : key_share
            length                          : 71
            data_of_type                    : [('secp256r1', (48439561293906451759052585252797914202762949526041747995844080717082404635286, 36134250956749795798585127919587881956611106672985015071877198253568414405109))]
```

* Client Hello 메시지의 key_share extension 보면 Elliptic Curve Diffie-Hellman 키교환을 사용하고 있으며 client의 key_share가 타원곡선 `secp256r1` 위의 점 `(48439561293906451759052585252797914202762949526041747995844080717082404635286, 36134250956749795798585127919587881956611106672985015071877198253568414405109)`이라는 것을 알 수 있다. 그런데 이 점은 타원곡선 `secp256r1`의 generator라고 불리는 특별한 상수이다. `48439561293906451759052585252797914202762949526041747995844080717082404635286`을 구글링하면 쉽게 정보를 얻을 수 있다. 원래 client의 key_share는 타원곡선의 generator라고 불리는 점에 32바이트 크기의 비밀인 랜덤 정수를 곱해서 얻어야 한다. 그런데 특별히 개조된 client는 그렇게 하지 않고 비밀이어야 할 랜덤 정수로 1을 사용한 것이다. 꼭 1이 아니더라도 이 값을 알아낼 수 있으면 server의 static private key를 몰라도 해당 세션의 TLS 패킷들을 모두 복호화할 수 있다.


### server_hello 메시지

* client가 받은 첫번째 record는 server_hello 메시지이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : handshake
version                         : TLS 1.2
length                          : 123
data_of_type
    type                            : server_hello
    length                          : 119
    data_of_type
        version                         : TLS 1.2
        random                          : 34e2af2f7c45ae218aecc7dcee69147f7add13970df54bae0f8c5fe40c58bfb9
        session_ID_length               : 0
        session_ID                      : 
        cipher_suite                    : TLS_AES_128_GCM_SHA256
        compression_method              : NULL
        extensions_length               : 79
        list_of_extensions
A list of 2 dictionaries
------------------------------------------------------------------------------------------------------------------------
            type                            : key_share
            length                          : 69
            data_of_type                    : ('secp256r1', (34505705120791959922243167741731098125706790969398927040701653022736414067424, 46835911507207088295931903857901970333239020476632120018816323831955793938514))
------------------------------------------------------------------------------------------------------------------------
            type                            : supported_versions
            length                          : 2
            data_of_type                    : TLS 1.3
```

* 키교환은 타원곡선 secp256r1을 이용한 Elliptic Curve Diffie-Hellman 알고리즘, 프로토콜 버전은 TLS 1.3, cipher_suite는 `TLS_AES_128_GCM_SHA256`으로 결정되었다.
* 따라서, 키유도에 사용할 해시함수는 `SHA256`이고 암호화에 사용할 알고리즘은 `AES-128-GCM`이다.

```python
hash_algo = "sha256"
hash_len = 32
key_len = 16
iv_len = 12
tag_len = 16
```

* Elliptic Curve Diffie-Hellman 키교환을 통해 양쪽이 합의하는 ecdh_shared_secret은 원래 server의 key_share에 client가 고른 32바이트 크기의 비밀인 랜덤 정수를 곱해 얻은 점의 x좌표 32바이트로 구해지는데 여기서는 client가 고른 정수가 1인 것을 알았으므로 server의 key_share의 x좌표 32바이트가 그대로 ecdh_shared_secret이 된다.

```python
server_key_share = (34505705120791959922243167741731098125706790969398927040701653022736414067424, 46835911507207088295931903857901970333239020476632120018816323831955793938514)
ecdh_shared_secret = server_key_share[0].to_bytes(32, "big", signed=False)

ecdh_shared_secret: 4c498978adb0dbdff8435373188f1dc1bb6cb00bd4ddc4e666bb6be71f0acae0 32 bytes
```

### 키 유도

* server_hello 메시지의 key_share를 이용해 ecdh_shared_secret를 구하고 [RFC 8446](https://datatracker.ietf.org/doc/html/rfc8446#section-7.1)를 참고하여 다음의 키들을 유도한다.

```python
import hashlib, hmac

def HKDF_Extract(salt, ikm, hash_algo):
    n = hashlib.new(hash_algo).digest_size
    if salt == b"": salt = b"\x00"*n
    return hmac.new(salt, ikm, hash_algo).digest()

def HKDF_Expand(prk, info, l, hash_algo):
    n = hashlib.new(hash_algo).digest_size
    assert len(prk) >= n and l <= 255*n
    if type(info) == str: info = info.encode("ascii")
    t = bytes(); cnt = 1
    while len(t) < l:
        s = t[-n:] + info + bytes([cnt]); cnt += 1
        t += hmac.new(prk, s, hash_algo).digest()
    return t[:l]

def TLS_HKDF_Expand_Label(secret, label, context, length, hash_algo):
    if type(label) == str: label = label.encode("ascii")
    label = b"tls13 " + label
    info = length.to_bytes(2, "big", signed=False) + bytes([len(label)]) + label + bytes([len(context)]) + context
    return HKDF_Expand(secret, info, length, hash_algo)

def TLS_DeriveSecret(secret, label, message, hash_algo):
    if type(label) == str: label = label.encode("ascii")
    digest = hashlib.new(hash_algo, message).digest()
    n = len(digest)
    return TLS_HKDF_Expand_Label(secret, label, digest, n, hash_algo)

zero_bytes = b"\x00"*hash_len
initial_salt = zero_bytes
pre_shared_secret = zero_bytes
early_secret = HKDF_Extract(initial_salt, pre_shared_secret, hash_algo)
early_derived_salt = TLS_DeriveSecret(early_secret, "derived", b"", hash_algo)
handshake_secret = HKDF_Extract(early_derived_salt, ecdh_shared_secret, hash_algo)
handshake_derived_salt = TLS_DeriveSecret(handshake_secret, "derived", b"", hash_algo)
master_secret = HKDF_Extract(handshake_derived_salt, zero_bytes, hash_algo)

ecdh_shared_secret: 4c498978adb0dbdff8435373188f1dc1bb6cb00bd4ddc4e666bb6be71f0acae0 32 bytes
early_secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a 32 bytes
handshake_secret: 2cd8d04a632835ef369f36feeae02af68b1f4ed4ed8f3679cfc688faf7c8b131 32 bytes
master_secret: bc0c12e2a76512bd34429d928ee61b9469f0195831034021611fc2657afec8d2 32 bytes
```

* 아직 handshake가 완료되지 않았으므로 남은 handshake 과정에서 client와 server가 주고 받을 데이터를 암호화하는데 실제 사용될 키를 유도한다. 이 때 `message`는 헤더를 제외한 client_hello 메시지와 server_hello 메시지이다.

```python
client_handshake_traffic_secret = TLS_DeriveSecret(handshake_secret, "c hs traffic", message, hash_algo)
server_handshake_traffic_secret = TLS_DeriveSecret(handshake_secret, "s hs traffic", message, hash_algo)

client_handshake_enc_key = TLS_HKDF_Expand_Label(client_handshake_traffic_secret, "key", b"", key_len, hash_algo)
client_handshake_enc_iv = TLS_HKDF_Expand_Label(client_handshake_traffic_secret, "iv", b"", iv_len, hash_algo)
client_handshake_hmac_key = TLS_HKDF_Expand_Label(client_handshake_traffic_secret, "finished", b"", hash_len, hash_algo)
server_handshake_enc_key = TLS_HKDF_Expand_Label(server_handshake_traffic_secret, "key", b"", key_len, hash_algo)
server_handshake_enc_iv = TLS_HKDF_Expand_Label(server_handshake_traffic_secret, "iv", b"", iv_len, hash_algo)
server_handshake_hmac_key = TLS_HKDF_Expand_Label(server_handshake_traffic_secret, "finished", b"", hash_len, hash_algo)

message: 010000be030300000000000000000000...cdbefab83e8922048852002b00020304 317 bytes
client_handshake_enc_key: 1055a6c70c3216a737c56134bc6430ed 16 bytes
client_handshake_enc_iv: a391b0a0bfc077ba61ab35d6 12 bytes
client_handshake_hmac_key: 9eec25e544910f986f2b0b11db97559c17d4f9916ed1d5ce3cf98edc6c0a3cff 32 bytes
server_handshake_enc_key: 957a4d6431453260c019e7f67a1245d0 16 bytes
server_handshake_enc_iv: dd89adcd6740475cfef1f91c 12 bytes
server_handshake_hmac_key: 3a0cdfb2228a505b74b162d2a5126be716efc76c5afc06597318f59d5004a7db 32 bytes
```

### change_cipher_spec 메시지

* client가 받은 두번째 record는 change_cipher_spec이다.
* server가 남아 있는 Handshake과정에서 사용할 key를 유도했으며 이후 server가 보내는 hasndshake 메시지는 암호화되어 있다는 것을 의미한다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : change_cipher_spec
version                         : TLS 1.2
length                          : 1
data_of_type                    : 1
```

### 암호화된 handshake 메시지

* client가 받은 세번째 record는 application_data 이며, 이것은 server가 보낸 암호화된 handshake 메시지 이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 2485
data_of_type                    : 82e71c107c3c2dd5d4f756e9ed66af54a406d1ffc8ad031c3579dc3d71523aac845e9e6d2a211283f9e963bb89a2f8ad16c4cdc431ba0fa2448b79868673c5d57619fa46e5d2f8b62dd2babaf6b42365d5164ed4d4fc7814bbeb6ad4a5df779120191da7a4299feb2c92ec7ff5feab49f634b89446c36e797f32cd71638c50f7...
```

* server_handshake_enc_key와 server_handshake_enc_iv를 이용해 다음과 같이 암호화된 handshake 메시지를 복호화한다.

```python
from Cryptography.BlockCipher import AES

key = server_handshake_enc_key
recv_seq = 0
iv = XOR(server_handshake_enc_iv, recv_seq.to_bytes(iv_len, "big", signed=False)); recv_seq += 1
ad = encrypted_data[:5]
ct = encrypted_data[5:-tag_len]
tag = encrypted_data[-tag_len:]
pt = AES.Decrypt_GCM(key, iv, ct, ad, tag)
decrypted_data = pt[-1:] + b"\x03\x03" + (len(pt)-1).to_bytes(2, "big", signed=False) + pt[:-1]
```

* 복호화하면 다음과 같은 handshake 메시지들을 볼 수 있다.

```
type                            : handshake
version                         : TLS 1.2
length                          : 2468
data_of_type
A list of 4 dictionaries
------------------------------------------------------------------------------------------------------------------------
    type                            : encrypted_extensions
    length                          : 2
    data_of_type                    : 0000
------------------------------------------------------------------------------------------------------------------------
    type                            : certificate
    length                          : 2344
    data_of_type                    : 000009240004cc308204c8308203b0a00302010202104e5a45d05e6c7c6f0300000000cc58e7300d06092a864886f70d01010b05003042310b3009060355040613025553311e301c060355040a1315476f6f676c65205472757374205365727669636573311330110603550403130a47545320434120314f31301e170d323130...
------------------------------------------------------------------------------------------------------------------------
    type                            : certificate_verify
    length                          : 74
    data_of_type                    : 04030046304402205d1f3737f08c217492ef72e9d7328115651daf2ccabb3b8f42f62537bad3d69702203c493db467b1f6464c4896012ba03c1e20f3bf3cfb085283fb1bf654ab3ff901
------------------------------------------------------------------------------------------------------------------------
    type                            : finished
    length                          : 32
    data_of_type                    : d720382a75e18ae785e9ec5e73bd9294b87f96905ca93276e83c374049acf7d8
```


### 키 유도

* server가 보낸 finished 메시지까지 봤으므로 handshake 완료 후 server와 client가 주고 받는 application_data를 암호화하는데 사용될 키를 유도할 수 있다. 이 때 `message`는 헤더를 제외한 client_hello, server_hello, encrypted_extension, certificate, certificate_verify, (server) finished 메시지이다.

```python
client_application_traffic_secret = TLS_DeriveSecret(master_secret, "c ap traffic", message, hash_algo)
server_application_traffic_secret = TLS_DeriveSecret(master_secret, "s ap traffic", message, hash_algo)

client_application_enc_key = TLS_HKDF_Expand_Label(client_application_traffic_secret, "key", b"", key_len, hash_algo)
client_application_enc_iv = TLS_HKDF_Expand_Label(client_application_traffic_secret, "iv", b"", iv_len, hash_algo)
server_application_enc_key = TLS_HKDF_Expand_Label(server_application_traffic_secret, "key", b"", key_len, hash_algo)
server_application_enc_iv = TLS_HKDF_Expand_Label(server_application_traffic_secret, "iv", b"", iv_len, hash_algo)

message: 010000be030300000000000000000000...b87f96905ca93276e83c374049acf7d8 2785 bytes
client_application_enc_key: 4912bdefed3aa8e94085c94e94d852f6 16 bytes
client_application_enc_iv: a858db0848c59dc3229e56e2 12 bytes
server_application_enc_key: 17c34dac5d8c6d1b515f6a757e9596cd 16 bytes
server_application_enc_iv: b917fde4be9e8d61e3014577 12 bytes
```

### change_cipher_spec 메시지

* client가 보낸 두번째 record는 change_cipher_spec이다.
* client가 남아 있는 Handshake과정에서 사용할 key를 유도했으며 이후 server에게 보내는 hasndshake 메시지는 암호화되어 있다는 것을 의미한다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : change_cipher_spec
version                         : TLS 1.2
length                          : 1
data_of_type                    : 1
```

### 암호화된 handshake 메시지

* client가 보낸 세번째 record는 application_data 이며, 이것은 client가 보낸 암호화된 handshake 메시지 이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 53
data_of_type                    : 94aac92027a5485a1f3b7014750fd6b8a133074a9f5acb548461380e2cf2f9f7ec4f22ad0d9d01ba3771e014f1ed12b141093cc6aa
```

* client_handshake_enc_key와 client_handshake_enc_iv를 이용해 다음과 같이 암호화된 handshake 메시지를 복호화한다.

```python
from Cryptography.BlockCipher import AES

key = client_handshake_enc_key
send_seq = 0
iv = XOR(client_handshake_enc_iv, send_seq.to_bytes(iv_len, "big", signed=False)); send_seq += 1
ad = encrypted_data[:5]
ct = encrypted_data[5:-tag_len]
tag = encrypted_data[-tag_len:]
pt = AES.Decrypt_GCM(key, iv, ct, ad, tag)
decrypted_data = pt[-1:] + b"\x03\x03" + (len(pt)-1).to_bytes(2, "big", signed=False) + pt[:-1]
```

* 복호화하면 다음과 같은 handshake 메시지를 볼 수 있다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : handshake
version                         : TLS 1.2
length                          : 36
data_of_type
    type                            : finished
    length                          : 32
    data_of_type                    : f02f2a5a05991dd6b9a9ab2eaf93925432c2a3476931415af03100a523a02010
```

* client가 보내는 finished 메시지까지 봤으므로 모든 handshake과정이 완료된 것을 알 수 있다.

### HTTP 요청 메시지

* client가 보내는 마지막 record는 server에게 보내는 HTTP 요청을 암호화한 application_data 메시지이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 235
data_of_type                    : 13c975c5a0bb8d6f65bbffc993249babf103c1b08c4a25e0686c23b036ea0499c6234b5ec6bbb8cb479468ed4ae84e9cacd66240e63b221fa0e472e12c14b831b5258fe0af6c1257fa3d395bcb0fa1f49788724a291a97d40648e1a8cb09f4f47598b12908dd51af8e680401739cac787988d8e865357fcfb38a627a8afce78a...
```

* client_application_enc_key와 client_application_enc_iv를 이용해 다음과 같이 암호화된 handshake 메시지를 복호화한다.

```python
from Cryptography.BlockCipher import AES

key = client_application_enc_key
send_seq = 0
iv = XOR(client_application_enc_iv, send_seq.to_bytes(iv_len, "big", signed=False)); send_seq += 1
ad = encrypted_data[:5]
ct = encrypted_data[5:-tag_len]
tag = encrypted_data[-tag_len:]
pt = AES.Decrypt_GCM(key, iv, ct, ad, tag)
decrypted_data = pt[-1:] + b"\x03\x03" + (len(pt)-1).to_bytes(2, "big", signed=False) + pt[:-1]
```

* 복호화하면 다음과 같은 appliaction_data 메시지를 볼 수 있다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 218
data_of_type                    : 474554202f20485454502f312e310d0a486f73743a207777772e676f6f676c652e636f6d0d0a557365722d4167656e743a204d6f7a696c6c612f352e30202857696e646f7773204e542031302e303b2057696e36343b207836343b2072763a39302e3029204765636b6f2f32303130303130312046697265666f782f39302e30...
```

* appliaction_data를 문자열로 decode하면 client가 보낸 HTTP 요청을 볼 수 있다.

```
GET / HTTP/1.1
Host: www.google.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0
Flag: SCTF{RFC8446:The_Transport_Layer_Security_(TLS)_Protocol_Version_1.3_63a3a9e1}

```

### HTTP 응답 메시지

* server가 보내는 4번째 record 부터는 모두 client의 HTTP 요청에 대한 응답을 암호화한 application_data 메시지들이다.

```
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 1323
data_of_type                    : 3c07b9d97b873f016ee957ac6ba27259ca56d12329ed8e45ca5871b5206f4dd824c24a85d80afebc2d17c699a9d2c508232b4cb003d54076be5f61c1eb2334322855a6f1c37a3d9932bafd215fcef22c9e2a41a54480922f96b404ddad891d695152e21a84f49056acd06acf78aacd7aa02fd2c06cb009f7dfecd5437524829a...
------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 1323
data_of_type                    : 1a914df3d7320c0076c642e1c1b51bc0eabdc7e00b718d640cfedf52f7150f1c2c2c3f83f6c9745b33b6fc04eda835a95c9f5bd3d4384b06032750e19ea692a9f0de60d77a5c7289a19b1b31c2b197e8829b455a36db551cba6bb718f6d409c1dee60142f218a0271caaa15930e7fda7c3d93d62e0363c548a7f1300247ff26b...

...

------------------------------------------------------------------------------------------------------------------------
type                            : application_data
version                         : TLS 1.2
length                          : 426
data_of_type                    : 0f4bae9c8ddcf57ea471f606b24e8934f19b62ad7b6b6318d461eddab23d6161d8615dfe5d2b3d488b8eb4feacf0cf0e4f7d2ee71e8bdd52a29f92b8b59129b8b6cc02c12c059a711c0318631536dcf45f580cb6ef24c18979d0ca239d5ddbd2d0390f43f1ab235e9d88f77a4f6e1fb4e2cade11dd16e713bc50cf6bdc1b59fe
```

* 복호화 과정 생략
