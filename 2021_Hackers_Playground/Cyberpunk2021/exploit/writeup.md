Cyberpunk 2021 Writeup
===

##### Target:
> 353fc878067f95f89f5839fc52a6c5a7  cyberpunk

##### Exploitation:
Binary implements Breach Protocol puzzle like in video game Cyberpunk 2077 developed by CD Projekt.

Goal is to enter secret sequence in buffer from the 6x6 matrix, in less than 90 seconds. 
You have to start sequence from the first row at the top of the matrix. 
Then, your next value must be selected from the same column as the one youâ€™ve just selected.

After reverse engineering binary, turns out that matrix is filled with the random bytes of address of `system` and `sub_B5A` functions.
While, `sub_B5A` function is spawning the shell. 
```c
int sub_B5A() {
  return execv("/bin/sh", 0LL);
}
```

Function `sub_E9C` is a main game loop that prints matrix, buffer and moves cursor position left/right or up/down.
In fact, there is buffer overflow vulnerability in selected sequence buffer, since it's length is restricted by the size of matrix 6 * 6 = 36 while buffer fits only 8 bytes.
That means, we could overflow the buffer and substitute returning address from the game loop to spawning the shell function `sub_B5A`, despite ASLR enabled.

So, in order to exploit vulnerability, matrix have to contain `5A` and `?B` values to make path length of 18 bytes (8 buffer + 8 rbp + 2 last bytes `?B5A`).
Since, we are limited in time, automatic puzzle solver is needed.
