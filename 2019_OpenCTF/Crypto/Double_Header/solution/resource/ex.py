#we can get these values from pcap file
pubS=120224176479255123304794605173031337169019221725693374035245389705706445299241378854131277014782308912828296763585211408807084227502760416340191561277710027989464655857684039527615446197184687779996363605053470313956028031087671514618190771172685676140577465747972388884043441604634332329596698440730470612007
sharedsecret_XORed_message=3344439857734054809772230814787360863987485874572069675080104078889320661513577736294049046537937441875181285653529677913041024588601818783994900194148408840426788373213215045704488889148372202663934222603308425961160621941587583583617540379299565360707940126763257067876244672996912870207903890879428687682916828272912547643871453939714675192047007817703627237621456971065322972661824144012795383447260173221877673256817520350733536018420152648379270295873113891540731055658025321355350734051391

#get parameter values
param = open("client_params.dat").read().strip()
exec(param)

#calculate shared secret
sharedsecret = pow(pubS, privC, p)

#get message
message = sharedsecret_XORed_message ^ sharedsecret
print hex(message)[2:-1].decode("hex")
