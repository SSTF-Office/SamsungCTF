from Crypto.Cipher import Salsa20

byte_2B09 = "0A1D1316244956262D011800284F220A210E020A291C564E6C2517092D1F130B234F5D450F00040C2D0112003E4F5D450B0E0409250C564E6C3F13153C0A0445674F2400284F390B25001845674F3117290A184503011F0A224F5D450F071F09254F5D451F1A11043E4F5D450F1A1B0C224F5D4500061B006C4456362D030265".decode("hex")
byte_2B89 = "E1215350A6DC9371661A817DEA304E6C8FFC8121A96E7738642E61BF8F986D3CDE4D00DB3918C2B40A4F3CFE23".decode("hex")


def sub_830():
    return ''.join((chr(ord(x) ^ ord(y)) for x, y in zip(byte_2B09, "Love" * (len(byte_2B09) / 4))))


def sub_85C(buffer):
    return ''.join((chr(
        ord(buffer[i * 4]) ^
        ord(buffer[i * 4 + 1]) ^
        ord(buffer[i * 4 + 2]) ^
        ord(buffer[i * 4 + 3])
    ) for i in xrange(32)))


def sub_B70(key):
    return Salsa20.new(key, nonce=b"Cooking\0")


def sub_C30(cipher, input):
    return cipher.decrypt(input)


buffer = sub_830()
print buffer

key = sub_85C(buffer)
cipher = sub_B70(key)
decrypt = sub_C30(cipher, byte_2B89)

print decrypt
