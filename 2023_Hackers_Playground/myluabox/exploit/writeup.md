- We can generate the admin JWT by analyzing the binary `myluabox`.
  - The binary `myluabox` is stripped, but the JWT key and level exist in plain text.
- Analyze the binary `luaagent` to find vulnerabilities that can escape the Lua sandbox.
  - In the function `main`, the `Lua::globals` is copied to the registry named `backup`.
  - In the function `functions::load_functions`, there are user-defined functions `random_seed`, `load`, `require`, ...
  - As a result of analysis focusing on the `registry`, the function `require` returns the cached value if the required file is cached in the registry.
  - We can use the `Lua::globals` by requiring the registry `backup`.
  - https://docs.rs/mlua/latest/mlua/struct.Lua.html#method.globals
  - https://docs.rs/mlua/latest/mlua/struct.Lua.html#method.named_registry_value
- Finally, We can get the contents of the flag file by calling the function `string.dump` after `loadfile`.
